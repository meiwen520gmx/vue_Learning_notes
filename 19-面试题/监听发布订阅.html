<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script>
    //数据监听器函数
    function Observer(data){
      this.data = data;
      this.init();
    }
    Observer.prototype.init = function(){
      let data = this.data;
      Object.keys(data).forEach(key => {
        this.defineReactive(data, key, data[key]);
      })
    }
    Observer.prototype.defineReactive = function(data, key, value){
      //递归遍历子对象
      let childObj = observer(value);
      //对对象的属性进行监听
      Object.defineProperty(data, key, {
        enumerable: true,
        configurable: true,
        get(){
          return value;
        },
        set(newVal){
          if(newVal == value){
            return
          }
          value = newVal;
          //如果新值是对象的话，递归该对象，进行监听
          childObj = observer(newVal);
        }
      })
    }
   function observer(value){
     if(!value || typeof value !== 'object'){
       return;
     }
     return new Observer(value);
   }

   let obj = {
     name: "gaominxue",
     age: "24",
     family: {
       num: 4
     }
   }
   Observer(obj);//进行监听
   obj.name = "gmx";
   console.log(obj);



  </script>
</body>
</html>